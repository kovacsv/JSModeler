<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	 "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>

	<meta http-equiv="content-type" content="text/html;charset=utf-8">
	<link rel="stylesheet" type="text/css" href="include/viewertest.css">

	<script type="text/javascript" src="../../build/three.min.js"></script>
<!-- JSModeler includes start -->
	<script type="text/javascript" src="../../src/core/jsm.js"></script>
	<script type="text/javascript" src="../../src/core/timer.js"></script>
	<script type="text/javascript" src="../../src/core/algorithm.js"></script>
	<script type="text/javascript" src="../../src/core/async.js"></script>
	<script type="text/javascript" src="../../src/core/check.js"></script>
	<script type="text/javascript" src="../../src/core/jsonloader.js"></script>
	<script type="text/javascript" src="../../src/geometry/definitions.js"></script>
	<script type="text/javascript" src="../../src/geometry/coord2d.js"></script>
	<script type="text/javascript" src="../../src/geometry/coord.js"></script>
	<script type="text/javascript" src="../../src/geometry/determinant.js"></script>
	<script type="text/javascript" src="../../src/geometry/coordutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/matrix.js"></script>
	<script type="text/javascript" src="../../src/geometry/coordsystem.js"></script>
	<script type="text/javascript" src="../../src/geometry/sector.js"></script>
	<script type="text/javascript" src="../../src/geometry/line.js"></script>
	<script type="text/javascript" src="../../src/geometry/box.js"></script>
	<script type="text/javascript" src="../../src/geometry/sphere.js"></script>
	<script type="text/javascript" src="../../src/geometry/transformation.js"></script>
	<script type="text/javascript" src="../../src/geometry/plane.js"></script>
	<script type="text/javascript" src="../../src/geometry/projection.js"></script>
	<script type="text/javascript" src="../../src/geometry/convexhull.js"></script>
	<script type="text/javascript" src="../../src/geometry/polygon2d.js"></script>
	<script type="text/javascript" src="../../src/geometry/polygon.js"></script>
	<script type="text/javascript" src="../../src/geometry/triangulation.js"></script>
	<script type="text/javascript" src="../../src/geometry/octree.js"></script>
	<script type="text/javascript" src="../../src/geometry/bsptree.js"></script>
	<script type="text/javascript" src="../../src/geometry/utilities.js"></script>
	<script type="text/javascript" src="../../src/geometry/ray.js"></script>
	<script type="text/javascript" src="../../src/modeler/body.js"></script>
	<script type="text/javascript" src="../../src/modeler/model.js"></script>
	<script type="text/javascript" src="../../src/modeler/color.js"></script>
	<script type="text/javascript" src="../../src/modeler/material.js"></script>
	<script type="text/javascript" src="../../src/modeler/adjacencyinfo.js"></script>
	<script type="text/javascript" src="../../src/modeler/bodyutils.js"></script>
	<script type="text/javascript" src="../../src/modeler/textureutils.js"></script>
	<script type="text/javascript" src="../../src/modeler/cututils.js"></script>
	<script type="text/javascript" src="../../src/modeler/generator.js"></script>
	<script type="text/javascript" src="../../src/modeler/camera.js"></script>
	<script type="text/javascript" src="../../src/modeler/explode.js"></script>
	<script type="text/javascript" src="../../src/modeler/exporter.js"></script>
	<script type="text/javascript" src="../../src/modeler/trianglebody.js"></script>
	<script type="text/javascript" src="../../src/modeler/trianglemodel.js"></script>
	<script type="text/javascript" src="../../src/modeler/converter.js"></script>
	<script type="text/javascript" src="../../src/modeler/rayutils.js"></script>
	<script type="text/javascript" src="../../src/import/binaryreader.js"></script>
	<script type="text/javascript" src="../../src/import/importer.js"></script>
	<script type="text/javascript" src="../../src/import/importer3ds.js"></script>
	<script type="text/javascript" src="../../src/import/importerobj.js"></script>
	<script type="text/javascript" src="../../src/import/importerstl.js"></script>
	<script type="text/javascript" src="../../src/import/importercommon.js"></script>
	<script type="text/javascript" src="../../src/renderer/webglutils.js"></script>
	<script type="text/javascript" src="../../src/renderer/renderlight.js"></script>
	<script type="text/javascript" src="../../src/renderer/rendermaterial.js"></script>
	<script type="text/javascript" src="../../src/renderer/rendermesh.js"></script>
	<script type="text/javascript" src="../../src/renderer/renderbody.js"></script>
	<script type="text/javascript" src="../../src/renderer/shaderprogram.js"></script>
	<script type="text/javascript" src="../../src/renderer/renderer.js"></script>
	<script type="text/javascript" src="../../src/renderer/pointcloudrenderer.js"></script>
	<script type="text/javascript" src="../../src/renderer/renderconverter.js"></script>
	<script type="text/javascript" src="../../src/viewer/mouse.js"></script>
	<script type="text/javascript" src="../../src/viewer/touch.js"></script>
	<script type="text/javascript" src="../../src/viewer/painter.js"></script>
	<script type="text/javascript" src="../../src/viewer/drawing.js"></script>
	<script type="text/javascript" src="../../src/viewer/navigation.js"></script>
	<script type="text/javascript" src="../../src/viewer/softwareviewer.js"></script>
	<script type="text/javascript" src="../../src/viewer/spriteviewer.js"></script>
	<script type="text/javascript" src="../../src/viewer/viewer.js"></script>
	<script type="text/javascript" src="../../src/viewer/pointcloudviewer.js"></script>
	<script type="text/javascript" src="../../src/extras/solidgenerator.js"></script>
	<script type="text/javascript" src="../../src/extras/extgenerator.js"></script>
	<script type="text/javascript" src="../../src/extras/subdivision.js"></script>
	<script type="text/javascript" src="../../src/extras/csg.js"></script>
	<script type="text/javascript" src="../../src/extras/curves.js"></script>
	<script type="text/javascript" src="../../src/extensions/threeviewer/threeconverter.js"></script>
	<script type="text/javascript" src="../../src/extensions/threeviewer/threeviewer.js"></script>
	<script type="text/javascript" src="../../src/extensions/svgtomodel/svgtomodel.js"></script>
<!-- JSModeler includes end -->

	<script type="text/javascript" src="include/stephandler.js"></script>
	<script type="text/javascript" src="include/teststeps.js"></script>
	<title>JSModeler Camera Test</title>

	<script type="text/javascript">
		var viewer = null;
		var distanceLimitSet = false;

		function Resize ()
		{
			var header = document.getElementById ('header');
			var canvas = document.getElementById ('test');
			
			canvas.width = document.body.clientWidth;
			canvas.height = document.body.clientHeight - header.clientHeight - 1;
		}

		function WriteCameraInfo ()
		{
			var info = document.getElementById ('info');
			info.innerHTML = '';
			info.innerHTML += 'fixUp: ' + viewer.navigation.cameraFixUp + ', ';
			info.innerHTML += 'orbit: ' + viewer.navigation.cameraEnableOrbit + ', ';
			info.innerHTML += 'pan: ' + viewer.navigation.cameraEnablePan + ', ';
			info.innerHTML += 'zoom: ' + viewer.navigation.cameraEnableZoom + ', ';
			info.innerHTML += 'near limit: ' + viewer.navigation.cameraNearDistanceLimit + ', ';
			info.innerHTML += 'far limit: ' + viewer.navigation.cameraFarDistanceLimit;
		}
		
		function Reset1 ()
		{
			viewer.SetCamera (new JSM.Coord (-7.5, -5.0, 4.0), new JSM.Coord (-1.5, 0.0, 0.0), new JSM.Coord (0.0, 0.0, 1.0));
			viewer.Draw ();
		}
		
		function Reset2 ()
		{
			viewer.SetCamera (new JSM.Coord (-6.0, -5.0, 4.0), new JSM.Coord (0.0, 0.0, 0.0), new JSM.Coord (0.0, 0.0, 1.0));
			viewer.Draw ();
		}

		function Reset3 ()
		{
			viewer.SetCamera (new JSM.Coord (-4.5, -5.0, 4.0), new JSM.Coord (1.5, 0.0, 0.0), new JSM.Coord (0.0, 0.0, 1.0));
			viewer.Draw ();
		}

		function SwitchFixUp ()
		{
			viewer.navigation.cameraFixUp = !viewer.navigation.cameraFixUp;
			WriteCameraInfo ();
		}
		
		function SwitchOrbit ()
		{
			viewer.navigation.EnableOrbit (!viewer.navigation.cameraEnableOrbit);
			WriteCameraInfo ();
		}

		function SwitchPan ()
		{
			viewer.navigation.EnablePan (!viewer.navigation.cameraEnablePan);
			WriteCameraInfo ();
		}

		function SwitchDistanceLimit ()
		{
			if (!distanceLimitSet) {
				viewer.navigation.SetNearDistanceLimit (5.0);
				viewer.navigation.SetFarDistanceLimit (10.0);
			} else {
				viewer.navigation.SetNearDistanceLimit (0.1);
				viewer.navigation.SetFarDistanceLimit (1000.0);
			}
			distanceLimitSet = !distanceLimitSet;
			WriteCameraInfo ();
		}

		function SwitchZoom ()
		{
			viewer.navigation.cameraEnableZoom
			viewer.navigation.EnableZoom (!viewer.navigation.cameraEnableZoom);
			WriteCameraInfo ();
		}

		function Load ()
		{
			window.onresize = Resize;
			Resize ();

			var viewerSettings = {
				cameraEyePosition : [-6.0, -5.0, 4.0],
				cameraCenterPosition : [0.0, 0.0, 0.0],
				cameraUpVector : [0.0, 0.0, 1.0]
			};

			viewer = new JSM.ThreeViewer ();
			if (!viewer.Start (document.getElementById ('test'), viewerSettings)) {
				return;
			}

			var body1 = JSM.GenerateCuboid (1, 1, 1);
			viewer.AddMeshes (JSM.ConvertBodyToThreeMeshes (body1));
			
			var body2 = JSM.GenerateCuboid (1, 1, 1);
			body2.Transform (new JSM.TranslationTransformation (new JSM.Coord (1.5, 0.0, 0.0)));
			viewer.AddMeshes (JSM.ConvertBodyToThreeMeshes (body2));

			var body3 = JSM.GenerateCuboid (1, 1, 1);
			body3.Transform (new JSM.TranslationTransformation (new JSM.Coord (-1.5, 0.0, 0.0)));
			viewer.AddMeshes (JSM.ConvertBodyToThreeMeshes (body3));

			var body4 = JSM.GenerateCuboid (1, 1, 1);
			body4.Transform (new JSM.TranslationTransformation (new JSM.Coord (0.0, 0.0, 1.5)));
			viewer.AddMeshes (JSM.ConvertBodyToThreeMeshes (body4));

			WriteCameraInfo ();
			viewer.Draw ();
		}

	    window.onload = function ()
		{
			Load ();
		}
	</script>

</head>

<body>
	<div id="header">
		<div id="buttons">
			<a class="button" href="javascript:Reset1 ()">reset 1</a>
			<a class="button" href="javascript:Reset2 ()">reset 2</a>
			<a class="button" href="javascript:Reset3 ()">reset 3</a>
			<a class="button" href="javascript:SwitchFixUp ()">fix up</a>
			<a class="button" href="javascript:SwitchOrbit ()">orbit</a>
			<a class="button" href="javascript:SwitchPan ()">pan</a>
			<a class="button" href="javascript:SwitchZoom ()">zoom</a>
			<a class="button" href="javascript:SwitchDistanceLimit ()">distance limit</a>
		</div>
		<div id="info"></div>
	</div>
	<canvas id="test" width="800" height="500"></canvas>
</body>

</html>
